#include <stdio.h>

int n;                    // number of states
int eclose[20][20];       // store epsilon closures
int visited[20];          // to avoid repetition
int ep[20][20];           // epsilon transitions (adjacency list)

void epsilonClosure(int state, int root) {
    for(int i = 0; i < n; i++) {
        if(ep[state][i] == 1 && !visited[i]) { 
            visited[i] = 1;
            eclose[root][i] = 1;
            epsilonClosure(i, root);
        }
    }
}

int main() {
    int i, j, e, from, to;

    printf("Enter number of states: ");
    scanf("%d", &n);

    // Initialize all arrays
    for(i = 0; i < n; i++) {
        for(j = 0; j < n; j++) {
            ep[i][j] = 0;
            eclose[i][j] = 0;
        }
    }

    printf("Enter number of ε-transitions: ");
    scanf("%d", &e);

    printf("Enter ε-transitions (from to):\n");
    for(i = 0; i < e; i++) {
        scanf("%d %d", &from, &to);
        ep[from][to] = 1;
    }

    // Calculate epsilon-closure for each state
    for(i = 0; i < n; i++) {
        for(j = 0; j < n; j++)
            visited[j] = 0;

        visited[i] = 1;
        eclose[i][i] = 1;

        epsilonClosure(i, i);
    }

    // Print results
    printf("\nEpsilon Closures:\n");
    for(i = 0; i < n; i++) {
        printf("ε-closure(%d) = { ", i);
        for(j = 0; j < n; j++) {
            if(eclose[i][j] == 1)
                printf("%d ", j);
        }
        printf("}\n");
    }

    return 0;
}
